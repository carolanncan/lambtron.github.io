<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Metalsmith-Hover: A Plugin to Show Gifs on Hover</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="twitter:creator" content="andyjiang">
    <meta name="twitter:card" content="">
    <link rel="alternate" type="application/atom+xml" href="atom.xml">
    <link rel="stylesheet" href="/index.css">
    <script type="text/javascript">
      !function(){var analytics=window.analytics=window.analytics||[];if(!analytics.initialize)if(analytics.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{analytics.invoked=!0;analytics.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","group","track","ready","alias","page","once","off","on"];analytics.factory=function(t){return function(){var e=Array.prototype.slice.call(arguments);e.unshift(t);analytics.push(e);return analytics}};for(var t=0;t<analytics.methods.length;t++){var e=analytics.methods[t];analytics[e]=analytics.factory(e)}analytics.load=function(t){var e=document.createElement("script");e.type="text/javascript";e.async=!0;e.src=("https:"===document.location.protocol?"https://":"http://")+"cdn.segment.com/analytics.js/v1/"+t+"/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(e,n)};analytics.SNIPPET_VERSION="3.0.1";
      analytics.load('425safDNzgGhWwGte2oSmvBDQLrTSycN');
      }}();
    </script>
  </head>
  <body>
    <div class="Layout">
      <div class="Layout-nav">
        <div class="Profile">
          <a class="Profile-avatar" href="/"></a>
          <h1 class="Profile-name Heading Heading--medium"><a href="/">Andy Jiang</a></h4>
          <p class="Profile-role">Derp Engineer at <a class="Link" href="https://segment.com">Segment</a></p>
        
          <ul class="Profile-links">
            <a class="Profile-link Profile-twitter-link" href="https://twitter.com/andyjiang">Twitter</a>
            <a class="Profile-link Profile-github-link" href="https://github.com/lambtron">GitHub</a>
            
            <a class="Profile-link Profile-linkedin-link" href="https://linkedin.com/in/andyjiang">Dribbble</a>
            
            
            
            
            <a class="Profile-link Profile-rss-link" href="/atom.xml">RSS<a>
          </ul>
        
          <a class="Profile-twitter-button twitter-follow-button" href="https://twitter.com/andyjiang" data-show-count="false">Follow @andyjiang</a>
          <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
        </div>      </div>
      <div class="Layout-main"><article class="Article">
  <a class="Article-home" href="/">Home</a>
  <h1 class="Article-title Heading Heading--huge">Metalsmith-Hover: A Plugin to Show Gifs on Hover</h1>
  <time class="Article-date" datetime="2015-07-14T00:00:00.000Z">Monday, 13 July 2015</time>
  <div class="Article-content Prose Prose--medium">
    <style>
a > img { display: none; }
a:hover > img { display: block; position: absolute; z-index: 99 }
</style><p>I have some <a href="http://media.giphy.com/media/s7PYWohoEXPCo/giphy.gif">exciting news<img src="http://media.giphy.com/media/s7PYWohoEXPCo/giphy.gif"></a> to share&#x2014;not only did I write my first <a href="https://www.metalsmith.io">Metalsmith</a> plugin, but also it&#x2019;s live on my blog! <a href="http://www.reactiongifs.com/r/dnc.gif">Wewt<img src="http://www.reactiongifs.com/r/dnc.gif"></a>! I&#x2019;ll discuss how I went about doing so in this <a href="http://i.imgur.com/hRxquuu.jpg">post<img src="http://i.imgur.com/hRxquuu.jpg"></a>, so come for the <a href="https://38.media.tumblr.com/cb6da16d6949f8fc6a363b40538f7e49/tumblr_inline_nctv9c7ODq1sv49sn.gif">arguably trivial insights<img src="https://38.media.tumblr.com/cb6da16d6949f8fc6a363b40538f7e49/tumblr_inline_nctv9c7ODq1sv49sn.gif"></a> and stay for the <a href="http://replygif.net/i/343.gif">mediocre<img src="http://replygif.net/i/343.gif"></a> <a href="http://i.imgur.com/KpuscdT.gif">gifs<img src="http://i.imgur.com/KpuscdT.gif"></a>!</p>
<p>Inspired by such Chrome extensions such as <a href="https://chrome.google.com/webstore/detail/hover-zoom/nonjdcjchghhkdoolnlbekcfllmednbl?hl=en">Hover Zoom</a>, <a href="https://chrome.google.com/webstore/detail/ezlinkpreview/nnkcfbiefgdaceeplickkkmifpicbpcc?hl=en">ezLinkPreview</a>, <a href="https://chrome.google.com/webstore/detail/hover-link/ggbpdjpocpnohglmhmppdkimpoiklegb?hl=en-US">Hover Link</a>, <a href="https://chrome.google.com/webstore/detail/link-previews/hlbhbhdjmllabhmeoehogilodnpbmhgj?hl=en">Link Previews</a>, <a href="https://chrome.google.com/webstore/detail/hover-free/hcmnnggnaofmhflgomfjfbndngdoogkj?hl=en">Hover Free</a>, and <a href="https://www.google.com/webhp?sourceid=chrome-instant&amp;ion=1&amp;espv=2&amp;ie=UTF-8#q=chrome%20extension%20hover%20link">hundreds more</a>&#x2014;tools to drive all productivity on the Internet to a <a href="http://33.media.tumblr.com/8b0e3cbcfc4bdfbdad8320584128340c/tumblr_mmoodrLNAb1spes4io1_500.gif">mind numbingly infinite scroll<img src="http://33.media.tumblr.com/8b0e3cbcfc4bdfbdad8320584128340c/tumblr_mmoodrLNAb1spes4io1_500.gif"></a> fest of <a href="http://i.imgur.com/pz1C9fb.jpg">cat<img src="http://i.imgur.com/pz1C9fb.jpg"></a> <a href="https://38.media.tumblr.com/9ec0aeed0ef6f914d0daa05beb641648/tumblr_ndp649VVhG1s60v4go1_500.gif">gifs<img src="https://38.media.tumblr.com/9ec0aeed0ef6f914d0daa05beb641648/tumblr_ndp649VVhG1s60v4go1_500.gif"></a>&#x2014;I decided to <a href="http://media.giphy.com/media/GT9BB2Zm4VnI4/giphy.gif">half-bake<img src="http://media.giphy.com/media/GT9BB2Zm4VnI4/giphy.gif"></a> that right into my blog. Doing so would serve <a href="http://i.imgur.com/SBduuXe.jpg">two purpoises<img src="http://i.imgur.com/SBduuXe.jpg"></a>: 1) allow me to further <a href="http://media.giphy.com/media/xT7aLRxSYZkk0/giphy.gif">feed<img src="http://media.giphy.com/media/xT7aLRxSYZkk0/giphy.gif"></a> my <a href="http://media.giphy.com/media/4zwwZI3aSZgAg/giphy.gif">gif addiction<img src="http://media.giphy.com/media/4zwwZI3aSZgAg/giphy.gif"></a>, and 2) spread my <a href="http://i.imgur.com/QTvZAIO.gif">love of gifs<img src="http://i.imgur.com/QTvZAIO.gif"></a> to my handful of <a href="http://media.giphy.com/media/tpdtC6yLhvhgA/giphy.gif">devoted readers<img src="http://media.giphy.com/media/tpdtC6yLhvhgA/giphy.gif"></a>.</p>
<p>This blog is built with <a href="http://i.imgur.com/liYrWZw.jpg">Plato<img src="http://i.imgur.com/liYrWZw.jpg"></a> (a currently closed source <a href="https://www.segment.com/">Segment</a> project), which converts markdown files into a static site using <a href="https://www.metalsmith.io">Metalsmith</a> (another Segment project, but this one is open source!). Plato uses various Metalsmith plugins, so I knew that in order to add this hover link ability, I would first need to write a plugin for Metalsmith and then add that to <a href="http://i.imgur.com/QWfiTHO.jpg">Plato<img src="http://i.imgur.com/QWfiTHO.jpg"></a>.</p>
<h2 id="building-building-blocks-to-build-more-building-blocks">Building Building Blocks To Build More Building Blocks</h2>
<blockquote>
<p>A plug-in is a software component that adds a specific feature to an existing software application.</p>
</blockquote>
<p>Metalsmith itself is really just an abstraction for <a href="http://media.giphy.com/media/EreFiaDJ9zK6Y/giphy.gif">transforming<img src="http://media.giphy.com/media/EreFiaDJ9zK6Y/giphy.gif"></a> a directory of files. It takes a set of <a href="http://i.imgur.com/pMF6W7y.gif">files<img src="http://i.imgur.com/pMF6W7y.gif"></a> in the source directory, <a href="http://i.imgur.com/lgCDCa0.gif">manipulates each of them<img src="http://i.imgur.com/lgCDCa0.gif"></a> with the plugins, and then <a href="http://media.giphy.com/media/AWicoNvwT3xAI/giphy.gif">outputs the files<img src="http://media.giphy.com/media/AWicoNvwT3xAI/giphy.gif"></a> in the destination directory. It is the rich ecosystem of these plugins that make Metalsmith as powerful as it is.</p>
<p>There are plugins for <a href="https://www.github.com/segmentio/metalsmith-markdown">converting Markdown to HTML</a>, <a href="https://github.com/boushley/metalsmith-beautify">formatting your HTML, CSS, or JS files</a>, <a href="https://github.com/segmentio/metalsmith-templates">rendering any file through a templating engine of your choice</a>, <a href="http://www.metalsmith.io/#the-plugins">etc</a>.</p>
<p>And not surprisingly, this is certainly inline with <a href="https://segment.com/blog/building-building-blocks/">Segment&#x2019;s approach</a> to building software in <a href="http://i.imgur.com/Kh2Osoy.gif">modular, pluggable components<img src="http://i.imgur.com/Kh2Osoy.gif"></a>.</p>
<h2 id="what-happened-next-will-make-you-continue-to-sit-or-stand-there">What Happened Next Will Make You Continue To Sit (or Stand) There</h2>
<p>This is my first Metalsmith plugin! Basically, this plugin would</p>
<ul>
<li>take an HTML file</li>
<li>find all anchor tags where the <code>href</code> were images</li>
<li>append a hidden <code>img</code> tag that would reveal itself upon hover</li>
<li>prepend the necessary CSS to attach style to the <code>a:hover</code> pseudo class</li>
</ul>
<p>I decided to use <a href="https://github.com/cheeriojs/cheerio">Cheerio</a> for HTML/<a href="http://i.imgur.com/i9qbCIX.png">DOM<img src="http://i.imgur.com/i9qbCIX.png"></a> querying, just because I am most familiar with its API (I&#x2019;ve used it in previous projects with <a href="http://i.imgur.com/kpJspRB.png">great success<img src="http://i.imgur.com/kpJspRB.png"></a>).</p>
<p>Here is the <a href="https://github.com/lambtron/metalsmith-hover/blob/master/lib/index.js#L34-L44">meat of the logic</a>.</p>
<pre><code class="lang-javascript">function plugin() {
  return function(files, metalsmith, done) {
    Object.keys(files).forEach(function(file) {
      if (!~file.indexOf(&apos;.html&apos;)) return;
      var $ = cheerio.load(files[file].contents);
      var links = $(&apos;a&apos;);
      for (var i = links.length - 1; i &gt;= 0; i--) {
        var url = links[i].attribs.href;
        if (image(url)) $(links[i]).append(img(url));
      }
      $.root().prepend(css());
      files[file].contents = new Buffer($.html());
    });
    done();
  };
}
</code></pre>
<p><em>I&#x2019;m not 100% sure if this is the best way to do this, so if you have any suggestions, please don&#x2019;t hesitate to add an issue <a href="https://github.com/lambtron/metalsmith-hover/issues/new">here</a>!</em></p>
<p>One interesting thing to point out is that <a href="http://stackoverflow.com/questions/1033156/how-to-write-ahover-in-inline-css">you are not able to add inline styles to the <code>a:hover</code> pseudo class</a>. It is possible to use javascript and change the styles of the anchor element with <code>onMouseOver</code> and <code>onMouseOut</code> functions, but, for this <a href="http://media.giphy.com/media/2aFRDAaACkSXu/giphy.gif">wiener of a plugin<img src="http://media.giphy.com/media/2aFRDAaACkSXu/giphy.gif"></a>, it seemed to be too much.</p>
<p>Instead, I <a href="https://github.com/lambtron/metalsmith-hover/blob/master/lib/index.js#L42">prepended a <code>style</code> element</a> with <a href="https://github.com/lambtron/metalsmith-hover/blob/master/lib/index.js#L71-L77">the <code>a:hover</code> css code</a> to the root of the file&#x2019;s HTML, which works. And yes, that is a <a href="http://i.imgur.com/3R8DKRa.jpg"><code>z-index: 99</code><img src="http://i.imgur.com/3R8DKRa.jpg"></a> in my CSS code. Hey, I&#x2019;ve made it this far in life so I must be doing something right, <a href="http://media.giphy.com/media/Gvnh1m87wk2ek/giphy.gif">right<img src="http://media.giphy.com/media/Gvnh1m87wk2ek/giphy.gif"></a>? <a href="http://media.giphy.com/media/NsJs9nmLwAxag/giphy.gif">Right<img src="http://media.giphy.com/media/NsJs9nmLwAxag/giphy.gif"></a>?!</p>
<p><a href="http://media.giphy.com/media/8ppnU9unXdula/giphy.gif">Anyway<img src="http://media.giphy.com/media/8ppnU9unXdula/giphy.gif"></a>, the <a href="https://github.com/lambtron/metalsmith-hover">plugin is now available</a> for any brave soul to use. I only say that because, like <em>everything</em> I release into the <a href="http://33.media.tumblr.com/df06ab544c2cfddc6fad7242ca1a0fb0/tumblr_inline_nng15xQt631raprkq_500.gif">unforgiving conditions of the wild<img src="http://33.media.tumblr.com/df06ab544c2cfddc6fad7242ca1a0fb0/tumblr_inline_nng15xQt631raprkq_500.gif"></a>, it has <a href="http://media.giphy.com/media/fhWTD7YCd59D2/giphy.gif">no tests<img src="http://media.giphy.com/media/fhWTD7YCd59D2/giphy.gif"></a> (but hey, <a href="http://www.topito.com/wp-content/uploads/2013/01/code-08.gif">it works!<img src="http://www.topito.com/wp-content/uploads/2013/01/code-08.gif"></a>).</p>
<p>Install it like:</p>
<pre><code class="lang-shell">$ npm install metalsmith-hover
</code></pre>
<p>And use it like (assuming the source directory has Markdown files, which I hope is true for all of you writers out there!):</p>
<pre><code class="lang-javascript">var Metalsmith = require(&apos;metalsmith&apos;);
var markdown = require(&apos;metalsmith-markdown&apos;);
var hover = require(&apos;metalsmith-hover&apos;);

var metalsmith = Metalsmith(__dirname)
  .use(markdown())
  .use(hover())
  .build(function(err) {
    if (err) throw err;
  });
</code></pre>
<h2 id="gif-the-people-what-they-want">Gif the People What They Want</h2>
<p>Now that I have this great plugin, how do I get it onto this wonderful blog so that I can save you a click to view <a href="http://ak-hdl.buzzfed.com/static/2013-11/enhanced/webdr01/21/11/anigif_enhanced-buzz-25559-1385050824-30.gif">these<img src="http://ak-hdl.buzzfed.com/static/2013-11/enhanced/webdr01/21/11/anigif_enhanced-buzz-25559-1385050824-30.gif"></a> <a href="http://ak-hdl.buzzfed.com/static/2013-11/enhanced/webdr02/21/12/anigif_enhanced-buzz-25961-1385055442-5.gif">awesome<img src="http://ak-hdl.buzzfed.com/static/2013-11/enhanced/webdr02/21/12/anigif_enhanced-buzz-25961-1385055442-5.gif"></a> <a href="http://ak-hdl.buzzfed.com/static/2013-11/enhanced/webdr03/21/11/anigif_enhanced-buzz-27147-1385051681-11.gif">gifs<img src="http://ak-hdl.buzzfed.com/static/2013-11/enhanced/webdr03/21/11/anigif_enhanced-buzz-27147-1385051681-11.gif"></a>?</p>
<p>Plato, which is used to turn a series of <a href="http://media.giphy.com/media/1bWDLvRtlhgk0/giphy.gif">poorly formed thoughts<img src="http://media.giphy.com/media/1bWDLvRtlhgk0/giphy.gif"></a> hastily thrown into a collection of Markdown files into <a href="https://github.com/lambtron/lambtron.github.io">this</a>, a beautiful static-site that is hosted on <a href="https://www.github.com">GitHub</a>, has a <code>plugins.js</code> file. This file is where you can add whatever Metalsmith plugin you would like.</p>
<p>I added <code>metalsmith-hover</code>, saved the blog, and <a href="http://media.giphy.com/media/Lmhk4bVpRn4YM/giphy.gif">deployed it<img src="http://media.giphy.com/media/Lmhk4bVpRn4YM/giphy.gif"></a>. <a href="http://i.imgur.com/kEgvj.gif">Boom<img src="http://i.imgur.com/kEgvj.gif"></a>!</p>
<p>It&#x2019;s all about the first rule of journalism: <a href="http://i.imgur.com/Vca79Bt.gif">give the people what they want<img src="http://i.imgur.com/Vca79Bt.gif"></a>!</p>
<p>I hope you enjoyed this! <a href="https://www.twitter.com/andyjiang">Tweet at me</a> if you have any <a href="http://media.giphy.com/media/MJTOHmGiGPHgI/giphy.gif">questions<img src="http://media.giphy.com/media/MJTOHmGiGPHgI/giphy.gif"></a>, <a href="http://media.giphy.com/media/Bt7yp8KpygqYg/giphy.gif">comments<img src="http://media.giphy.com/media/Bt7yp8KpygqYg/giphy.gif"></a>, or just <a href="http://media.giphy.com/media/oGfEeawH6DrZ6/giphy.gif">want to chat<img src="http://media.giphy.com/media/oGfEeawH6DrZ6/giphy.gif"></a>.</p>
<p><em>Like what you read? Share this article and follow me on <a href="http://www.twitter.com/andyjiang">Twitter</a> for random musings.</em></p>

  </div>
</article>
<script>
  analytics.page('Article', {
    article: {
      name: "Metalsmith-Hover: A Plugin to Show Gifs on Hover",
      date: "2015-07-14T00:00:00.000Z"
    }
  });
</script>
      </div>
    </div>
    <script src="/index.js"></script>
  </body>
</html>